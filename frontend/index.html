<!DOCTYPE html>
<html>
    <head>
        <title>Tic Tac Toe</title>
        <style>
            body { font-family: Arial, sans-serif; text-align: center; margin: 50px; }
            .board { display: grid; grid-template-columns: repeat(3, 100px); gap: 5px; margin: 20px auto; width: 310px; }
            .cell { width: 100px; height: 100px; border: 2px solid #333; display: flex; align-items: center; 
                   justify-content: center; font-size: 2em; cursor: pointer; background: #f0f0f0; }
            .cell:hover { background: #e0e0e0; }
            .status { margin: 20px; font-size: 1.2em; }
            button { padding: 10px 20px; font-size: 1em; margin: 10px; cursor: pointer; }
        </style>
    </head>
    <body>
        <h1>Tic Tac Toe</h1>
        <div class="status" id="status">Click New Game to start!</div>
        <div class="board" id="board"></div>
        <button onclick="newGame()">New Game</button>
        
        <script>
            let currentGameId = null;
            
            async function newGame() {
                const response = await fetch('/game', { method: 'POST' });
                const game = await response.json();
                currentGameId = game.game_id;
                updateBoard(game);
            }
            
            async function makeMove(position) {
                if (!currentGameId) return;
                
                const response = await fetch(`/game/${currentGameId}/move/${position}`, { method: 'POST' });
                const game = await response.json();
                updateBoard(game);
            }
            
            function updateBoard(game) {
                const board = document.getElementById('board');
                board.innerHTML = '';
                
                game.board.forEach((cell, index) => {
                    const cellDiv = document.createElement('div');
                    cellDiv.className = 'cell';
                    cellDiv.textContent = cell;
                    cellDiv.onclick = () => !game.game_over && cell === ' ' && makeMove(index);
                    board.appendChild(cellDiv);
                });
                
                const status = document.getElementById('status');
                if (game.game_over) {
                    status.textContent = game.winner ? 
                        (game.winner === 'X' ? 'You win!' : 'Computer wins!') : 
                        "It's a tie!";
                } else {
                    status.textContent = game.current_player === 'X' ? 
                        "Your turn (X)" : "Computer's turn (O)";
                }
            }
            
            // Initialize empty board
            document.getElementById('board').innerHTML = Array(9).fill()
                .map((_, i) => `<div class="cell" onclick="alert('Start a new game first!')"></div>`)
                .join('');
        </script>
    </body>
</html>
